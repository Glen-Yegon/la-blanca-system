/*!
 * mime-types
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";var db=require("mime-db"),extname=require("path").extname,mimeScore=require("./mimeScore"),EXTRACT_TYPE_REGEXP=/^\s*([^;\s]*)(?:;|\s|$)/,TEXT_TYPE_REGEXP=/^text\//i;function charset(e){if(!e||"string"!=typeof e)return!1;var t=EXTRACT_TYPE_REGEXP.exec(e),r=t&&db[t[1].toLowerCase()];return r&&r.charset?r.charset:!(!t||!TEXT_TYPE_REGEXP.test(t[1]))&&"UTF-8"}function contentType(e){if(!e||"string"!=typeof e)return!1;var t=-1===e.indexOf("/")?exports.lookup(e):e;if(!t)return!1;if(-1===t.indexOf("charset")){var r=exports.charset(t);r&&(t+="; charset="+r.toLowerCase())}return t}function extension(e){if(!e||"string"!=typeof e)return!1;var t=EXTRACT_TYPE_REGEXP.exec(e),r=t&&exports.extensions[t[1].toLowerCase()];return!(!r||!r.length)&&r[0]}function lookup(e){if(!e||"string"!=typeof e)return!1;var t=extname("x."+e).toLowerCase().slice(1);return t&&exports.types[t]||!1}function populateMaps(e,t){Object.keys(db).forEach(function(r){var o=db[r].extensions;if(o&&o.length){e[r]=o;for(var n=0;n<o.length;n++){var s=o[n];t[s]=_preferredType(s,t[s],r);const e=_preferredTypeLegacy(s,t[s],r);e!==t[s]&&exports._extensionConflicts.push([s,e,t[s]])}}})}function _preferredType(e,t,r){return(t?mimeScore(t,db[t].source):0)>(r?mimeScore(r,db[r].source):0)?t:r}function _preferredTypeLegacy(e,t,r){var o=["nginx","apache",void 0,"iana"],n=t?o.indexOf(db[t].source):0,s=r?o.indexOf(db[r].source):0;return"application/octet-stream"!==exports.types[extension]&&(n>s||n===s&&"application/"===exports.types[extension]?.slice(0,12))||n>s?t:r}exports.charset=charset,exports.charsets={lookup:charset},exports.contentType=contentType,exports.extension=extension,exports.extensions=Object.create(null),exports.lookup=lookup,exports.types=Object.create(null),exports._extensionConflicts=[],populateMaps(exports.extensions,exports.types);