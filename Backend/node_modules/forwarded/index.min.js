/*!
 * forwarded
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";function forwarded(e){if(!e)throw new TypeError("argument req is required");var r=parse(e.headers["x-forwarded-for"]||"");return[getSocketAddr(e)].concat(r)}function getSocketAddr(e){return e.socket?e.socket.remoteAddress:e.connection.remoteAddress}function parse(e){for(var r=e.length,t=[],o=e.length,s=e.length-1;s>=0;s--)switch(e.charCodeAt(s)){case 32:o===r&&(o=r=s);break;case 44:o!==r&&t.push(e.substring(o,r)),o=r=s;break;default:o=s}return o!==r&&t.push(e.substring(o,r)),t}module.exports=forwarded;