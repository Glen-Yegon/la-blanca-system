"use strict";var test=require("tape"),getSideChannelWeakMap=require("../");test("getSideChannelMap",{skip:"function"!=typeof WeakMap&&"function"!=typeof Map},function(e){var t=getSideChannelWeakMap||function(){throw new EvalError("should never happen")};e.test("export",function(e){e.equal(typeof t,"function","is a function"),e.equal(t.length,0,"takes no arguments");var a=t();e.ok(a,"is truthy"),e.equal(typeof a,"object","is an object"),e.end()}),e.test("assert",function(e){var a=t();e.throws(function(){a.assert({})},TypeError,"nonexistent value throws");var n={};a.set(n,"data"),e.doesNotThrow(function(){a.assert(n)},"existent value noops"),e.end()}),e.test("has",function(e){var a=t(),n=[];e.equal(a.has(n),!1,"nonexistent value yields false"),a.set(n,"foo"),e.equal(a.has(n),!0,"existent value yields true"),e.equal(a.has("abc"),!1,"non object value non existent yields false"),a.set("abc","foo"),e.equal(a.has("abc"),!0,"non object value that exists yields true"),e.end()}),e.test("get",function(e){var a=t(),n={};e.equal(a.get(n),void 0,"nonexistent value yields undefined");var s={};a.set(n,s),e.equal(a.get(n),s,'"get" yields data set by "set"'),e.end()}),e.test("set",function(e){var a=t(),n=function(){};e.equal(a.get(n),void 0,"value not set"),a.set(n,42),e.equal(a.get(n),42,"value was set"),a.set(n,1/0),e.equal(a.get(n),1/0,"value was set again");var s={};a.set(s,17),e.equal(a.get(n),1/0,"o is not modified"),e.equal(a.get(s),17,"o2 is set"),a.set(n,14),e.equal(a.get(n),14,"o is modified"),e.equal(a.get(s),17,"o2 is not modified"),e.end()}),e.test("delete",function(e){var a=t(),n={};e.equal(a.delete({}),!1,"nonexistent value yields false"),a.set(n,42),e.equal(a.has(n),!0,"value is set"),e.equal(a.delete({}),!1,"nonexistent value still yields false"),e.equal(a.delete(n),!0,"deleted value yields true"),e.equal(a.has(n),!1,"value is no longer set"),e.end()}),e.end()}),test("getSideChannelMap, no WeakMaps and/or Maps",{skip:"function"==typeof WeakMap||"function"==typeof Map},function(e){e.equal(getSideChannelWeakMap,!1,"is false"),e.end()});