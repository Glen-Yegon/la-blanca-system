"use strict";var parseUrl=require("url").parse,DEFAULT_PORTS={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},stringEndsWith=String.prototype.endsWith||function(r){return r.length<=this.length&&-1!==this.indexOf(r,this.length-r.length)};function getProxyForUrl(r){var t="string"==typeof r?parseUrl(r):r||{},e=t.protocol,n=t.host,o=t.port;if("string"!=typeof n||!n||"string"!=typeof e)return"";if(e=e.split(":",1)[0],!shouldProxy(n=n.replace(/:\d*$/,""),o=parseInt(o)||DEFAULT_PORTS[e]||0))return"";var s=getEnv("npm_config_"+e+"_proxy")||getEnv(e+"_proxy")||getEnv("npm_config_proxy")||getEnv("all_proxy");return s&&-1===s.indexOf("://")&&(s=e+"://"+s),s}function shouldProxy(r,t){var e=(getEnv("npm_config_no_proxy")||getEnv("no_proxy")).toLowerCase();return!e||"*"!==e&&e.split(/[,\s]/).every(function(e){if(!e)return!0;var n=e.match(/^(.+):(\d+)$/),o=n?n[1]:e,s=n?parseInt(n[2]):0;return!(!s||s===t)||(/^[.*]/.test(o)?("*"===o.charAt(0)&&(o=o.slice(1)),!stringEndsWith.call(r,o)):r!==o)})}function getEnv(r){return process.env[r.toLowerCase()]||process.env[r.toUpperCase()]||""}exports.getProxyForUrl=getProxyForUrl;