"use strict";module.exports=preferredLanguages,module.exports.preferredLanguages=preferredLanguages;var simpleLanguageRegExp=/^\s*([^\s\-;]+)(?:-([^\s;]+))?\s*(?:;(.*))?$/;function parseAcceptLanguage(e){for(var r=e.split(","),a=0,t=0;a<r.length;a++){var u=parseLanguage(r[a].trim(),a);u&&(r[t++]=u)}return r.length=t,r}function parseLanguage(e,r){var a=simpleLanguageRegExp.exec(e);if(!a)return null;var t=a[1],u=a[2],n=t;u&&(n+="-"+u);var i=1;if(a[3])for(var s=a[3].split(";"),l=0;l<s.length;l++){var o=s[l].split("=");"q"===o[0]&&(i=parseFloat(o[1]))}return{prefix:t,suffix:u,q:i,i:r,full:n}}function getLanguagePriority(e,r,a){for(var t={o:-1,q:0,s:0},u=0;u<r.length;u++){var n=specify(e,r[u],a);n&&(t.s-n.s||t.q-n.q||t.o-n.o)<0&&(t=n)}return t}function specify(e,r,a){var t=parseLanguage(e);if(!t)return null;var u=0;if(r.full.toLowerCase()===t.full.toLowerCase())u|=4;else if(r.prefix.toLowerCase()===t.full.toLowerCase())u|=2;else if(r.full.toLowerCase()===t.prefix.toLowerCase())u|=1;else if("*"!==r.full)return null;return{i:a,o:r.i,q:r.q,s:u}}function preferredLanguages(e,r){var a=parseAcceptLanguage(void 0===e?"*":e||"");if(!r)return a.filter(isQuality).sort(compareSpecs).map(getFullLanguage);var t=r.map(function(e,r){return getLanguagePriority(e,a,r)});return t.filter(isQuality).sort(compareSpecs).map(function(e){return r[t.indexOf(e)]})}function compareSpecs(e,r){return r.q-e.q||r.s-e.s||e.o-r.o||e.i-r.i||0}function getFullLanguage(e){return e.full}function isQuality(e){return e.q>0}