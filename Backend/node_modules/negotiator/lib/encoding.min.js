"use strict";module.exports=preferredEncodings,module.exports.preferredEncodings=preferredEncodings;var simpleEncodingRegExp=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function parseAcceptEncoding(n){for(var e=n.split(","),r=!1,i=1,t=0,o=0;t<e.length;t++){var c=parseEncoding(e[t].trim(),t);c&&(e[o++]=c,r=r||specify("identity",c),i=Math.min(i,c.q||1))}return r||(e[o++]={encoding:"identity",q:i,i:t}),e.length=o,e}function parseEncoding(n,e){var r=simpleEncodingRegExp.exec(n);if(!r)return null;var i=r[1],t=1;if(r[2])for(var o=r[2].split(";"),c=0;c<o.length;c++){var s=o[c].trim().split("=");if("q"===s[0]){t=parseFloat(s[1]);break}}return{encoding:i,q:t,i:e}}function getEncodingPriority(n,e,r){for(var i={encoding:n,o:-1,q:0,s:0},t=0;t<e.length;t++){var o=specify(n,e[t],r);o&&(i.s-o.s||i.q-o.q||i.o-o.o)<0&&(i=o)}return i}function specify(n,e,r){var i=0;if(e.encoding.toLowerCase()===n.toLowerCase())i|=1;else if("*"!==e.encoding)return null;return{encoding:n,i:r,o:e.i,q:e.q,s:i}}function preferredEncodings(n,e,r){var i=parseAcceptEncoding(n||""),t=r?function(n,e){if(n.q!==e.q)return e.q-n.q;var i=r.indexOf(n.encoding),t=r.indexOf(e.encoding);return-1===i&&-1===t?e.s-n.s||n.o-e.o||n.i-e.i:-1!==i&&-1!==t?i-t:-1===i?1:-1}:compareSpecs;if(!e)return i.filter(isQuality).sort(t).map(getFullEncoding);var o=e.map(function(n,e){return getEncodingPriority(n,i,e)});return o.filter(isQuality).sort(t).map(function(n){return e[o.indexOf(n)]})}function compareSpecs(n,e){return e.q-n.q||e.s-n.s||n.o-e.o||n.i-e.i}function getFullEncoding(n){return n.encoding}function isQuality(n){return n.q>0}