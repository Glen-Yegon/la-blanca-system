"use strict";var inspect=require("../"),test=require("tape"),mockProperty=require("mock-property"),hasSymbols=require("has-symbols/shams")(),hasToStringTag=require("has-tostringtag/shams")(),forEach=require("for-each"),semver=require("semver");test("values",function(e){e.plan(1);e.equal(inspect([{},[],{"a-b":5}]),"[ {}, [], { 'a-b': 5 } ]")}),test("arrays with properties",function(e){e.plan(1);var t=[3];t.foo="bar";var n=[1,2,t];n.baz="quux",n.index=-1,e.equal(inspect(n),"[ 1, 2, [ 3, foo: 'bar' ], baz: 'quux', index: -1 ]")}),test("has",function(e){e.plan(1),e.teardown(mockProperty(Object.prototype,"hasOwnProperty",{delete:!0})),e.equal(inspect({a:1,b:2}),"{ a: 1, b: 2 }")}),test("indexOf seen",function(e){e.plan(1);var t=[1,2,3,{}];t.push(t);var n=[];n.indexOf=void 0,e.equal(inspect(t,{},0,n),"[ 1, 2, 3, {}, [Circular] ]")}),test("seen seen",function(e){e.plan(1);var t=[1,2,3],n=[t];n.indexOf=void 0,e.equal(inspect(t,{},0,n),"[Circular]")}),test("seen seen seen",function(e){e.plan(1);var t=[1,2,3],n=[5,t];n.indexOf=void 0,e.equal(inspect(t,{},0,n),"[Circular]")}),test("symbols",{skip:!hasSymbols},function(e){var t=Symbol("foo");e.equal(inspect(t),"Symbol(foo)",'Symbol("foo") should be "Symbol(foo)"'),"symbol"==typeof t&&e.equal(inspect(Object(t)),"Object(Symbol(foo))",'Object(Symbol("foo")) should be "Object(Symbol(foo))"'),e.test("toStringTag",{skip:!hasToStringTag},function(e){e.plan(1);var t={};t[Symbol.toStringTag]="Symbol",e.equal(inspect(t),"{ [Symbol(Symbol.toStringTag)]: 'Symbol' }","object lying about being a Symbol inspects as an object")}),e.end()}),test("Map",{skip:"function"!=typeof Map},function(e){var t=new Map;t.set({a:1},["b"]),t.set(3,NaN);var n="Map (2) {"+inspect({a:1})+" => "+inspect(["b"])+", 3 => NaN}";e.equal(inspect(t),n,'new Map([[{ a: 1 }, ["b"]], [3, NaN]]) should show size and contents'),e.equal(inspect(new Map),"Map (0) {}","empty Map should show as empty");var s=new Map;s.set(s,t),e.equal(inspect(s),"Map (1) {[Circular] => "+n+"}","Map containing a Map should work"),e.end()}),test("WeakMap",{skip:"function"!=typeof WeakMap},function(e){var t=new WeakMap;t.set({a:1},["b"]);e.equal(inspect(t),"WeakMap { ? }",'new WeakMap([[{ a: 1 }, ["b"]]]) should not show size or contents'),e.equal(inspect(new WeakMap),"WeakMap { ? }","empty WeakMap should not show as empty"),e.end()}),test("Set",{skip:"function"!=typeof Set},function(e){var t=new Set;t.add({a:1}),t.add(["b"]);var n="Set (2) {"+inspect({a:1})+", "+inspect(["b"])+"}";e.equal(inspect(t),n,'new Set([{ a: 1 }, ["b"]]) should show size and contents'),e.equal(inspect(new Set),"Set (0) {}","empty Set should show as empty");var s=new Set;s.add(t),s.add(s),e.equal(inspect(s),"Set (2) {"+n+", [Circular]}","Set containing a Set should work"),e.end()}),test("WeakSet",{skip:"function"!=typeof WeakSet},function(e){var t=new WeakSet;t.add({a:1});e.equal(inspect(t),"WeakSet { ? }","new WeakSet([{ a: 1 }]) should not show size or contents"),e.equal(inspect(new WeakSet),"WeakSet { ? }","empty WeakSet should not show as empty"),e.end()}),test("WeakRef",{skip:"function"!=typeof WeakRef},function(e){var t=new WeakRef({a:1});e.equal(inspect(t),"WeakRef { ? }","new WeakRef({ a: 1 }) should not show contents"),e.end()}),test("FinalizationRegistry",{skip:"function"!=typeof FinalizationRegistry},function(e){var t=new FinalizationRegistry(function(){});e.equal(inspect(t),"FinalizationRegistry [FinalizationRegistry] {}","new FinalizationRegistry(function () {}) should work normallys"),e.end()}),test("Strings",function(e){var t="abc";e.equal(inspect(t),"'abc'","primitive string shows as such"),e.equal(inspect(t,{quoteStyle:"single"}),"'abc'","primitive string shows as such, single quoted"),e.equal(inspect(t,{quoteStyle:"double"}),'"abc"',"primitive string shows as such, double quoted"),e.equal(inspect(Object(t)),"Object("+inspect(t)+")","String object shows as such"),e.equal(inspect(Object(t),{quoteStyle:"single"}),"Object("+inspect(t,{quoteStyle:"single"})+")","String object shows as such, single quoted"),e.equal(inspect(Object(t),{quoteStyle:"double"}),"Object("+inspect(t,{quoteStyle:"double"})+")","String object shows as such, double quoted"),e.end()}),test("Numbers",function(e){e.equal(inspect(42),String(42),"primitive number shows as such"),e.equal(inspect(Object(42)),"Object("+inspect(42)+")","Number object shows as such"),e.end()}),test("Booleans",function(e){e.equal(inspect(!0),String(!0),"primitive true shows as such"),e.equal(inspect(Object(!0)),"Object("+inspect(!0)+")","Boolean object true shows as such"),e.equal(inspect(!1),String(!1),"primitive false shows as such"),e.equal(inspect(Object(!1)),"Object("+inspect(!1)+")","Boolean false object shows as such"),e.end()}),test("Date",function(e){var t=new Date;e.equal(inspect(t),String(t),"Date shows properly"),e.equal(inspect(new Date(NaN)),"Invalid Date","Invalid Date shows properly"),e.end()}),test("RegExps",function(e){e.equal(inspect(/a/g),"/a/g","regex shows properly"),e.equal(inspect(new RegExp("abc","i")),"/abc/i","new RegExp shows properly");var t="abc abc".match(/[ab]+/);delete t.groups,e.equal(inspect(t),"[ 'ab', index: 0, input: 'abc abc' ]","RegExp match object shows properly"),e.end()}),test("Proxies",{skip:"function"!=typeof Proxy||!hasToStringTag},function(e){var t={proxy:!0},n=new Proxy(t,{has:function(){return!1}}),s=semver.satisfies(process.version,"6.0 - 6.4");forEach(["Boolean","Number","String","Symbol","Date"],function(a){t[Symbol.toStringTag]=a,e.equal(inspect(n),"{ "+(s?"":"proxy: true, ")+"[Symbol(Symbol.toStringTag)]: '"+a+"' }","Proxy for + "+a+" shows as the target, which has no slots")}),e.end()}),test("fakers",{skip:!hasToStringTag},function(e){var t={proxy:!1};forEach(["Boolean","Number","String","Symbol","Date"],function(n){t[Symbol.toStringTag]=n,e.equal(inspect(t),"{ proxy: false, [Symbol(Symbol.toStringTag)]: '"+n+"' }","Object pretending to be "+n+" does not trick us")}),e.end()});