/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";exports.parse=parse,exports.serialize=serialize;var __toString=Object.prototype.toString,__hasOwnProperty=Object.prototype.hasOwnProperty,cookieNameRegExp=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,cookieValueRegExp=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,domainValueRegExp=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,pathValueRegExp=/^[\u0020-\u003A\u003D-\u007E]*$/;function parse(e,r){if("string"!=typeof e)throw new TypeError("argument str must be a string");var t={},i=e.length;if(i<2)return t;var a=r&&r.decode||decode,o=0,n=0,s=0;do{if(-1===(n=e.indexOf("=",o)))break;if(-1===(s=e.indexOf(";",o)))s=i;else if(n>s){o=e.lastIndexOf(";",n-1)+1;continue}var p=startIndex(e,o,n),d=endIndex(e,n,p),u=e.slice(p,d);if(!__hasOwnProperty.call(t,u)){var c=startIndex(e,n+1,s),f=endIndex(e,s,c);34===e.charCodeAt(c)&&34===e.charCodeAt(f-1)&&(c++,f--);var l=e.slice(c,f);t[u]=tryDecode(l,a)}o=s+1}while(o<i);return t}function startIndex(e,r,t){do{var i=e.charCodeAt(r);if(32!==i&&9!==i)return r}while(++r<t);return t}function endIndex(e,r,t){for(;r>t;){var i=e.charCodeAt(--r);if(32!==i&&9!==i)return r+1}return t}function serialize(e,r,t){var i=t&&t.encode||encodeURIComponent;if("function"!=typeof i)throw new TypeError("option encode is invalid");if(!cookieNameRegExp.test(e))throw new TypeError("argument name is invalid");var a=i(r);if(!cookieValueRegExp.test(a))throw new TypeError("argument val is invalid");var o=e+"="+a;if(!t)return o;if(null!=t.maxAge){var n=Math.floor(t.maxAge);if(!isFinite(n))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+n}if(t.domain){if(!domainValueRegExp.test(t.domain))throw new TypeError("option domain is invalid");o+="; Domain="+t.domain}if(t.path){if(!pathValueRegExp.test(t.path))throw new TypeError("option path is invalid");o+="; Path="+t.path}if(t.expires){var s=t.expires;if(!isDate(s)||isNaN(s.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+s.toUTCString()}if(t.httpOnly&&(o+="; HttpOnly"),t.secure&&(o+="; Secure"),t.partitioned&&(o+="; Partitioned"),t.priority)switch("string"==typeof t.priority?t.priority.toLowerCase():t.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(t.sameSite)switch("string"==typeof t.sameSite?t.sameSite.toLowerCase():t.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function decode(e){return-1!==e.indexOf("%")?decodeURIComponent(e):e}function isDate(e){return"[object Date]"===__toString.call(e)}function tryDecode(e,r){try{return r(e)}catch(r){return e}}