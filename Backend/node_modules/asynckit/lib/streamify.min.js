var async=require("./async.js");function wrapIterator(r){var t=this;return function(a,e,n){var i=async(wrapIteratorCallback.call(t,n,e));return t.jobs[e]=i,2==r.length?r(a,i):r(a,e,i)}}function wrapCallback(r){var t=this;return function(a,e){return finisher.call(t,a,e,r)}}function wrapIteratorCallback(r,t){var a=this;return function(e,n){if(t in a.jobs)return delete a.jobs[t],streamer.call(a,e,{key:t,value:n},r);r(e,n)}}function streamer(r,t,a){if(r&&!this.error)return this.error=r,this.pause(),this.emit("error",r),void a(r,t&&t.value);this.push(t),a(r,t&&t.value)}function finisher(r,t,a){r||this.push(null),a(r,t)}module.exports={iterator:wrapIterator,callback:wrapCallback};