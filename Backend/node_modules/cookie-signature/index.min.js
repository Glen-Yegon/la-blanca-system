var crypto=require("crypto");exports.sign=function(e,r){if("string"!=typeof e)throw new TypeError("Cookie value must be provided as a string.");if(null==r)throw new TypeError("Secret key must be provided.");return e+"."+crypto.createHmac("sha256",r).update(e).digest("base64").replace(/\=+$/,"")},exports.unsign=function(e,r){if("string"!=typeof e)throw new TypeError("Signed cookie string must be provided.");if(null==r)throw new TypeError("Secret key must be provided.");var t=e.slice(0,e.lastIndexOf(".")),o=exports.sign(t,r),i=Buffer.from(o),n=Buffer.from(e);return!(i.length!==n.length||!crypto.timingSafeEqual(i,n))&&t};