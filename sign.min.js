import{auth,db}from"./firebase-config.js";import{createUserWithEmailAndPassword,signInWithEmailAndPassword}from"https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";import{doc,setDoc,getDoc}from"https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";document.getElementById("signupForm").addEventListener("submit",async t=>{t.preventDefault();const e=signupName.value.trim(),o=signupEmail.value.trim(),s=signupPassword.value.trim(),a=signupConfirm.value.trim(),n=signupRole.value.trim();if(s===a)try{const t=(await createUserWithEmailAndPassword(auth,o,s)).user;await setDoc(doc(db,"accounts",t.uid),{name:e,email:o,role:n}),"manager"===n?window.location.href="customer.html":"owner"===n&&(window.location.href="manager.html")}catch(t){console.error(t),alert(t.message)}else alert("Passwords do not match.")}),document.getElementById("loginForm").addEventListener("submit",async t=>{t.preventDefault();const e=loginEmail.value.trim(),o=loginPassword.value.trim();try{const t=(await signInWithEmailAndPassword(auth,e,o)).user,s=await getDoc(doc(db,"accounts",t.uid));if(!s.exists())return void alert("Profile not found.");const a=s.data();"manager"===a.role?window.location.href="customer.html":"owner"===a.role&&(window.location.href="manager.html")}catch(t){alert("Incorrect email or password.")}});const toggleButtons=document.querySelectorAll(".toggle-btn"),loginForm=document.getElementById("loginForm"),signupForm=document.getElementById("signupForm");toggleButtons.forEach(t=>{t.addEventListener("click",()=>{toggleButtons.forEach(t=>t.classList.remove("active")),t.classList.add("active"),"signup"===t.dataset.target?(loginForm.classList.add("hidden"),signupForm.classList.remove("hidden")):(signupForm.classList.add("hidden"),loginForm.classList.remove("hidden"))})}),document.querySelectorAll(".pw-toggle").forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.target,o=document.getElementById(e);"password"===o.type?(o.type="text",t.textContent="Hide"):(o.type="password",t.textContent="Show")})}),document.getElementById("backBtn").addEventListener("click",()=>{window.history.back()});